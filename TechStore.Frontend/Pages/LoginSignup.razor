@page "/loginSignup"
@inject HttpClient Http
@inject NavigationManager Navigation

<h3>Login / Signup</h3>

<div>
    <input @bind="Username" placeholder="Username" />
    <input type="password" @bind="Password" placeholder="Password" />
</div>
<div>
    <button @onclick="Signup">Sign Up</button>
    <button @onclick="Login">Login</button>
</div>
<p>@Message</p>

@code {
    private string Username { get; set; } = string.Empty;
    private string Password { get; set; } = string.Empty;
    private string Message { get; set; } = string.Empty;

    private async Task Signup()
    {
        var formData = new MultipartFormDataContent
        {
            { new StringContent(Username), "uname" },
            { new StringContent(Password), "password" }
        };

        var response = await Http.PostAsync("signup", formData);
        Message = response.IsSuccessStatusCode ? "Signup successful" : await response.Content.ReadAsStringAsync();
    }

    private async Task Login()
    {
        var formData = new MultipartFormDataContent
        {
            { new StringContent(Username), "uname" },
            { new StringContent(Password), "password" }
        };

        var response = await Http.PostAsync("login", formData);
        if (response.IsSuccessStatusCode)
        {
            Message = "Login successful";
            Navigation.NavigateTo("/home");
        }
        else
        {
            Message = await response.Content.ReadAsStringAsync();
        }
    }
}
